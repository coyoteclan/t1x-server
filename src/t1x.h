#include "jump.h"

#include "shared.h"

#include "hook.h"

static void ban();
static void unban();
std::tuple<bool, int, int, std::string> getBanInfoForIp(char* ip);

#ifdef DEBUG

static void test();

#endif

// We assume a cdecl calling convention on 32-bit


// Art

const char *catArt = R"(
    ⠀⠀⠀⣠⠖⠒⢤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡤⠒⠒⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⢠⡏⠀⠀⠀⠈⠓⣤⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡞⠁⠀⠀⠀⠘⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⣸⠀⠀⠀⠀⠀⠀⠈⠳⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⠞⠁⠀⠀⠀⠀⠀⠀⢧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⡟⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⡤⠤⠤⠤⠤⠤⠤⣤⠞⠁⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⣰⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⢀⡏⠀⠀⠀⠀⠀⣀⣤⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⢹⡀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣀⣀⠀⠀⠀⠀⠀⠀
    ⣸⠀⠀⠀⠀⠀⢰⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⣿⣿⣿⣧⠀⠀⠀⠀⠀⠀⠀⠘⡇⠀⠀⠀⠀⠀⢀⡴⠊⠉⠀⠀⠈⠉⠲⢄⠀⠀⠀
    ⣿⠀⣀⣀⣀⠀⠈⠻⢿⠿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠿⣿⠿⠃⠀⠀⢀⣀⣀⣀⠀⠀⡇⠀⠀⠀⠀⢀⡞⠀⠀⠀⠀⠀⠀⠀⠀⠀⠳⡄⠀
    ⢸⠀⢀⣀⣉⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢈⣉⣀⠀⠀⢰⠇⠀⠀⠀⠀⢸⡁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⡄
    ⠀⢧⡉⠉⠉⠀⠀⠀⠀⠀⠀⠈⠳⠶⠊⠙⠦⠴⠊⠀⠀⠀⠀⠀⠀⠀⠀⠈⠈⠉⠉⢠⠞⠀⠀⠀⠀⠀⠘⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇
    ⠀⠀⠳⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡴⠋⠀⠀⠀⠀⠀⠀⠀⠘⠢⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⡿
    ⠀⠀⠀⠀⠙⠦⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣴⡯⠤⠤⠤⠤⠤⢤⣄⡀⠀⠀⠀⠈⡆⠀⠀⠀⠀⠀⠀⠀⢀⡇
    ⠀⠀⠀⠀⠀⠀⠀⠉⠳⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠒⠚⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠳⣄⠀⢀⡇⠀⠀⠀⠀⠀⠀⠀⣼⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢳⡋⠀⠀⠀⠀⠀⠀⠀⡼⠁⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢙⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢳⡀⠀⠀⠀⠀⣠⠞⠁⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡧⠀⠀⢀⡴⠃⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡿⢀⡤⠛⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡏⢧⡀⠀⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠋⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠙⠢⣇⠀⠀⠀⠀⠀⠀⠀⠀⢰⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡷⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⢸⡄⠀⠀⠀⠀⠀⠀⠀⣿⠛⠙⠋⠛⠛⠒⢦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠰⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢷⠀⠀⠀⠈⡇⠀⠀⠀⠀⠀⠀⢀⡇⠀⠀⠀⠀⠀⠀⠀⠘⣆⠀⠀⠀⠀⠀⠀⠀⢸⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⠽⠀⠀⠀⢀⡧⠀⠀⠀⠀⠀⠀⣸⠀⠀⠀⠀⠀⠀⠀⠀⠀⣹⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢇⡀⢸⠀⠀⣏⠀⢰⠀⠀⠀⠀⢀⡟⠀⠀⠀⠀⠀⠀⠀⠀⢸⡅⠀⡖⠀⠀⠀⠀⢀⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠒⠒⠚⠓⠚⠲⠶⠖⠒⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠑⠓⠒⠖⠒⠒⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
)";

const char *sgosha = R"(
⣠⠚⠛⠻⣶⣷⣶⣷⣾⣶⣶⣾⡍⢸⢁⢦⡷⠁⡼⠀⠀⠀⡀⢠⠄⠀⡀⡄⡄⣄⣤⣄⣴⣖⣴⣿⠿⠿⠶⠲⢟⡋⢫⢡⣀⣢⣄⠀⠀⠀
⣿⠀⠀⠀⠀⠙⠻⣿⣿⣿⣿⣿⡿⢺⢀⣿⣿⡞⠁⠀⠀⠀⠀⠁⠒⠙⠓⣎⡶⠉⢘⣿⣷⣷⢖⣔⢴⠸⠷⢶⢘⢠⡺⡿⡯⡙⢿⢕⣫⠒
⣿⣦⠀⠀⠀⠀⠀⠀⠙⢿⣿⣿⡁⢺⠪⣿⡗⢳⡄⠀⠀⠀⠀⠀⠀⠀⠐⠈⣺⢮⣳⡧⣶⣾⢽⣵⡀⠀⢁⠠⢵⣝⢽⣿⣧⣰⢦⣭⡞⠀
⣽⣿⣧⠀⠀⠀⠀⠀⠀⠀⠙⠿⡳⢾⠁⢕⢸⡚⠇⠀⠀⠀⠀⠀⠀⠀⠀⠜⣱⣾⡛⢤⢷⢡⣽⡾⣿⡫⠫⠒⡥⣤⣾⣣⣿⣻⢼⠧⠀⠀
⠸⣿⣿⣇⠀⠀⠀⠀⠀⠀⠀⠀⠰⢾⢁⣿⣨⣦⠀⠀⠀⠀⠀⠀⣰⣤⣷⣼⣿⠿⢨⣶⣿⡎⠟⠻⢇⣄⣏⣍⢆⠋⢒⣷⠟⡉⢉⠒⠄⠀
⠠⢼⣫⣿⡄⠀⠀⠀⠀⠀⠀⠀⠂⠀⢺⣏⡾⠀⡄⠀⠀⢀⢶⣧⡶⠛⠉⠀⠀⠀⠀⣽⡙⠀⡀⣪⣭⡚⠊⠉⠠⠜⠈⠄⠀⠜⠘⡉⠀⠐
⠼⣻⣛⣻⡷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢳⣷⣁⣄⠀⢀⣼⠞⠉⠀⠂⠁⠀⠀⠀⢀⣿⣥⣉⣙⣭⡿⢧⠇⠀⠀⠀⠀⣀⡝⠶⠒⠛⡉⠁
⢯⣿⠫⡥⣱⣶⡀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣻⠼⡆⢱⠞⠁⠀⠀⠈⠀⠀⠀⠀⠀⣾⣻⣶⠇⢰⡿⡨⠥⡷⠖⠁⠈⠙⣊⡮⢤⡑⢟⡵⣍
⣨⣿⣾⡶⡀⢻⣧⠀⢀⠀⠀⠈⠀⠀⠀⠠⢻⢿⣿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣾⣛⠛⢶⣀⠒⠛⠉⠁⠀⠀⠀⠀⣄⠁⠒⢓⢰⡿⠟
⢾⣿⢿⣷⡼⣽⣹⣷⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⢀⢀⠀⠀⠀⠀⠀⠀⠁⢠⠯⠺⣱⢁⢂⢀⣤⢀⣀⣤⢊⢒⡪⠙⣒⣀⣒⣂⡱⣣⣀
⡈⢙⡀⠽⡛⡛⠻⢿⣣⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠜⠀⠀⠀⠀⠀⢠⡀⢀⣿⣿⣶⡿⠿⠿⠿⠿⠿⠟⠑⠋⠉⠉⠉⠉⠉⠋⠉⠉⠉⠉
⠹⠿⡷⠦⢶⣴⡴⣵⣚⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠔⡫⠍⠀⠀⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠁⠰⠁⠜⢒⢎⠞⠕⠂⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠌⡊⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠈⠁⠂⣴⡡⠊⡚⠄⡀⠀⠀⠰⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠀⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⢞⢞⡑⠏⠀⢰⣁⠀⠀⠀⠘⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠎⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢠⡦⠊⢤⠶⣵⡗⠻⡒⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⡔⠡⠌⠀⠤⣰⡝⣽⢗⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠢⣫⠢⠈⠀⣙⠁⢏⡮⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢠⢀⠀⠈⠀⢡⡑⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠈⠂⡀⠀⢈⡸⣣⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠠⢀⠀⠀⠄⣃⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⢠⣷⢦⢄⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⢰⡷⢘⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⡀
⠀⠀⠛⣶⢇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡠⣔⣶⣶⣽⣮⣿⣾⣾⣿
⠀⣀⡲⠏⠘⣆⠄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡛⡏⢻⠅⠐⠈⢙⠝⠉⠉
⠠⣾⠟⢐⠆⡋⢱⣶⡢⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣀⢿⡧⣃⡅⠀⠀⣀⡬⢴⣢⣠
⢀⠮⣢⡅⠀⠤⡰⣿⣛⣶⣶⣤⣀⣆⡀⠀⠀⠀⠀⠀⠛⢶⣴⣤⣶⡶⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣴⢽⢯⠟⡿⢇⣧⡦⢤⣵⣆⣼⣿⣿
⠚⠛⠤⣬⠉⡏⠯⣁⠈⠳⠒⠺⠛⠃⠣⢀⠀⠀⠀⠀⠀⠀⢱⠟⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⣿⣽⣯⣽⢺⣸⡻⠾⠿⠿⣽⣴⣿⣏⣿
⡴⠁⠀⠀⢀⡀⠀⠁⠀⣹⠏⠀⠀⠄⢀⡪⠲⠄⣀⣀⡀⡁⠉⠆⢃⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⣿⣷⣿⣿⣽⢿⣖⢁⡀⣹⠛⠏⡟⣻⢿
⠘⡐⠂⠐⡨⠉⠀⠀⢄⣯⠠⠤⠀⠀⠀⠀⠁⠀⠈⠉⠉⠉⠁⠒⠒⢡⢀⣀⢀⠀⣠⣴⣿⣏⣼⣆⣽⣻⣻⣟⣿⣿⣿⡛⡍⡐⢁⠭⢷⣷
⠀⠀⠀⠈⠀⠁⠀⡀⠀⠀⠀⠀⠈⠠⠀⢂⠄⠀⠀⠢⠄⠀⠀⠀⠀⠀⠈⠀⠁⠈⠈⠀⠉⠛⣲⢻⠿⡿⡗⢾⣩⣉⢋⠈⢁⡀⠀⠀⠀⠻
)";

static void meow()
{
    printf("%s\n", catArt);
}

static void gosha()
{
    printf("%s\n", sgosha);
}